<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Do we need additional share metadata included here? -->

    <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-46457317-11"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-46457317-11');
</script>

    <title>Exploring Attributions in the What-If Tool</title>
    
        <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <link rel="stylesheet" href="/what-if-tool/assets/css/material.min.css">
    <link rel="stylesheet" href="/what-if-tool/assets/css/material-components-web.min.css">
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:400,400italic,500,500italic,700,700italic" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Manrope:400,400italic,500,500italic,700,700italic" rel="stylesheet" type="text/css">

    <!-- <link href='/what-if-tool/assets/css/main.css' rel='stylesheet' type='text/css'> -->
    <link href='/what-if-tool/assets/css/new.css' rel='stylesheet' type='text/css'>
    <link rel="icon" href="/what-if-tool/assets/images/favicon.png" type="image/png"/>

  </head>

  <body>
    <div class="mdl-layout mdl-layout--no-desktop-drawer-button mdl-js-layout mdl-layout--fixed-header">
      
      <header class="mdl-layout__header">
        <div class="mdl-layout__header-row">
          <!-- Title -->
          <span class="mdl-layout__title"><a href="/what-if-tool/">What-If Tool</a></span>
          <!-- Add spacer, to align navigation to the right -->
          <div class="mdl-layout-spacer"></div>
          <!-- Navigation. We hide it in small screens. -->
          <nav class="mdl-navigation mdl-layout--large-screen-only">
            <a class="mdl-navigation__link" href="/what-if-tool/get-started/">GET STARTED</a>
            <a class="mdl-navigation__link" href="/what-if-tool/learn/">TUTORIALS</a>
            <a class="mdl-navigation__link" href="/what-if-tool/explore/">DEMOS</a>
            <a class="mdl-navigation__link" href="/what-if-tool/faqs/">FAQs</a>
            <a class="mdl-navigation__link" href="https://groups.google.com/forum/#!forum/what-if-tool" target="-_blank">GET INVOLVED<img class="header-arrow" src="/what-if-tool/assets/images/arrow-link-out.png"/></a>
            <a class="mdl-navigation__link" href="https://github.com/pair-code/what-if-tool" target="-_blank">GITHUB<img class="header-arrow" src="/what-if-tool/assets/images/arrow-link-out.png"/></a>
          </nav>
        </div>
      </header>
      <div class="mdl-layout__drawer">
        <span class="mdl-layout__title"><a href="/what-if-tool/">What-If Tool</a></span>
        <nav class="mdl-navigation">
          <a class="mdl-navigation__link" href="/what-if-tool/get-started/">GET STARTED</a>
          <a class="mdl-navigation__link" href="/what-if-tool/learn/">TUTORIALS</a>
          <a class="mdl-navigation__link" href="/what-if-tool/explore/">DEMOS</a>
          <a class="mdl-navigation__link" href="/what-if-tool/faqs/">FAQs</a>
          <a class="mdl-navigation__link" href="https://groups.google.com/forum/#!forum/what-if-tool" target="_blank">GET INVOLVED<img class="header-arrow" src="/what-if-tool/assets/images/arrow-link-out.png"/></a>
          <a class="mdl-navigation__link" href="https://github.com/pair-code/what-if-tool" target="-_blank">GITHUB<img class="header-arrow" src="/what-if-tool/assets/images/arrow-link-out.png"/></a>
          
          <!-- <a class="mdl-navigation__link" href="https://pair-code.github.io/facets/" target="-_blank">
            <i class="material-icons icon-style">star</i>
            <span>Facets</span>
          </a>
          <a class="mdl-navigation__link" href="https://js.tensorflow.org" target="-_blank">
            <i class="material-icons icon-style">star</i>
            <span>TensorFlow.js</span>
          </a> -->
        </nav>
      </div>
      
      <main class="mdl-layout__content hero-banner">
        <div class="tutorial-page-container mdl-grid">
          <div class="mdl-cell--8-col mdl-cell--8-col-tablet mdl-cell--4-col-phone">
            <div class="tutorial-breadcrumbs">
  <a href="/what-if-tool/learn">Learn</a> > <a href="/what-if-tool/learn/#analysis">Conducting Analysis in the What-If Tool</a> > Exploring Attributions
</div>
            <h2>Exploring Attributions in the What-If Tool</h2>
<p>Exploring feature attributions is a great way to understand what features a model is relying on when making a prediction. Many techniques exist to get feature attributions from a model’s predictions, such as <a href="https://christophm.github.io/interpretable-ml-book/lime.html">LIME</a>, <a href="https://github.com/ankurtaly/Integrated-Gradients">integrated gradients</a>, and <a href="https://github.com/slundberg/shap">shapley values</a>. WIT allows users to consume feature attributions from any technique along with model predictions, and then uses those attributions to enhance its visualizations.</p>
<p>The feature attributions can be provided to WIT in one of two ways:</p>
<ol>
<li>Through a Cloud AI Platform model that has <a href="https://cloud.google.com/ai-platform/prediction/docs/ai-explanations/overview">explanations</a> enabled. Details on setting up WIT for a Cloud AI Platform model can be found in the <a href="https://pair-code.github.io/what-if-tool/learn/tutorials/notebooks/">Getting Started in Notebooks tutorial</a>.</li>
<li>Through a custom prediction function that returns feature attributions for each prediction, in addition to the standard prediction results. This can be done for WIT in either TensorBoard or notebooks. See the tutorial on <a href="../custom-prediction">custom prediction functions</a> in WIT for details on how to set this up. The user defines how the attributions are calculated and WIT then takes those attributions and adds them to its visualizations.</li>
</ol>
<h3>Attribution Visualizations</h3>
<p>When attributions are returned along with predictions, new visualizations are enabled in WIT. When selecting a datapoint, the Datapoint Editor will do three things with the attribution information:</p>
<ol>
<li>Features in the datapoint will be sorted by their attribution values, with the features with the highest attributions being at the top of the list. This sort order can be changed by a dropdown at the top of the Datapoint Editor.</li>
<li>The exact attribution values for each feature will be listed next to each feature value.</li>
<li>The feature values will have their background colored by their feature attribution scores, to allow at-a-glance understanding of the individual feature attributions.</li>
</ol>
<div class="mdl-cell mdl-cell--12-col mdl-cell--6-col-tablet mdl-cell--4-col-phone">
  <img class="tutorial-image" src="/what-if-tool/assets/images/datapoint_attrs.png"/>
  <div class="tutorial-caption">Attribution values in the Datapoint Editor.</div>
</div>
<p>Additionally, the feature attribution values can be used in the datapoints visualization, as a way to organize the datapoints, using those values to control scatter plot axes, datapoint binning, or datapoint coloring.</p>
<div class="mdl-cell mdl-cell--12-col mdl-cell--6-col-tablet mdl-cell--4-col-phone">
  <img class="tutorial-image" src="/what-if-tool/assets/images/attr-scatters.png"/>
  <div class="tutorial-caption">Exploring an age-prediction regression model. Scatter plots of age versus predicted age for a test dataset, faceted into two plots by how important the “hours per week” feature was to each prediction.</div>
</div>
<p>In the “Performance” tab, in addition to the standard metrics that are calculated and shown, there will be a table of mean feature attributions across the entire dataset, sorted with the highest-attributed feature at the top. If you slice a dataset in this tab, each slice will have its own mean attributions table. This table uses the same color scale as the attribution value-based background colors in the Datapoint Editor. You can also use the feature attributions as a dimension to slice your dataset on in this tab, such as slicing the dataset into those with high attribution on a specific feature, versus those with low attribution on that feature, in order to compare the performance metrics on those two slices.</p>
<div class="mdl-cell mdl-cell--12-col mdl-cell--6-col-tablet mdl-cell--4-col-phone">
  <img class="tutorial-image" src="/what-if-tool/assets/images/mean_attrs.png"/>
  <div class="tutorial-caption">Mean attribution tables in the Performance tab for a regression model.</div>
</div>
<h3>Attribution-based Counterfactuals</h3>
<p>When attributions are provided to WIT, its counterfactual-generating capabilities are enhanced. In addition to being able to <a href="../counterfactual">find nearest counterfactuals through datapoint feature value similarity</a>, you can find nearest counterfactuals through attribution similarity. Switching to using attribution-based distance is controlled by a dropdown in the counterfactual controls area in the Vizualize module in the Datapoint Editor tab.</p>
<p>When finding nearest counterfactuals by attribution distance, WIT calculates the distance between two datapoints based on the difference in attribution values for each feature of a datapoint, instead of the difference in feature values. This gives you another way to explore the decision boundary of a model for a given datapoint, based purely on attributions from whatever methodology you are using to calculate feature-wise attributions.</p>
<div class="mdl-cell mdl-cell--12-col mdl-cell--6-col-tablet mdl-cell--4-col-phone">
  <img class="tutorial-image" src="/what-if-tool/assets/images/counterfactual-attr.png"/>
  <div class="tutorial-caption">Finding the closest counterfactual datapoint based on feature attributions as opposed to feature values.</div>
</div>

          </div>
          <div class="mdl-cell--4-col hide-me">
            <div class="tutorial-info-container">
              <div class="tutorial-info-header">time to read</div>
              <div class="tutorial-info-copy">15 minutes</div>
              <div class="tutorial-info-header">use with</div>
              <div class="tutorial-info-copy">Classification models<br/>Multi-class models<br/>Regression models</div>
              <div class="tutorial-info-header">before you begin</div>
              <div class="tutorial-info-copy">Have a trained model with logic that returns predictions and feature attributions and test dataset for analyzing.</div>
              <div class="tutorial-info-header">related demos</div>
              <div class="tutorial-info-copy">Regression Model: UCI Census Age Prediction</div>
              <div class="tutorial-info-header">takeaways</div>
              <div class="tutorial-info-copy">Learn how to analyze feature attributions in the What-If Tool.</div>
              <div class="tutorial-info-header">what-if questions</div>
              <div class="tutorial-info-copy">How do I view feature attributions in the What-If Tool?</div>
            </div>
          </div>
          <div class="tutorial-footer mdl-cell--8-col mdl-cell--8-col-tablet mdl-cell--4-col-phone">
            The What-If Tool is being actively developed and documentation is likely to change as we improve the tool. We want to hear from you! Leave us a note, feedback, or suggestion on <a href="https://groups.google.com/forum/#!forum/what-if-tool" target="_blank">our community group</a>.
          </div>
        </div>

        <div class="footer-container mdl-grid">
  <div class="mdl-cell mdl-cell--2-col mdl-cell--2-col-tablet mdl-cell--4-col-phone"><a href="https://pair.withgoogle.com/" target="_blank"><img src="/what-if-tool/assets/images/pair-logo.svg"/></a></div>
  <div class="mdl-cell mdl-cell--2-col mdl-cell--2-col-tablet mdl-cell--4-col-phone"><a href="https://research.google/teams/brain/pair/" target="_blank">Google Research</a></div>
  <div class="mdl-cell mdl-cell--2-col mdl-cell--2-col-tablet mdl-cell--4-col-phone"><a href="https://groups.google.com/forum/#!forum/what-if-tool" target="_blank">Get Involved</a></div>
  <div class="mdl-cell mdl-cell--2-col mdl-cell--2-col-tablet mdl-cell--4-col-phone"><a href="https://github.com/pair-code" target="_blank">Github</a></div>
  <div class="footer-icons mdl-cell mdl-cell--4-col mdl-cell--8-col-tablet mdl-cell--4-col-phone">
    <a href="mailto:peopleai@google.com" target="_blank"><img src="/what-if-tool/assets/images/mail.png"/></a>
    <a href="https://medium.com/people-ai-research" target="_blank"><img src="/what-if-tool/assets/images/medium.png"/></a>
    <a href="https://www.youtube.com/channel/UCnnns-uu4yy9BXfYSPIX5AA" target="_blank"><img src="/what-if-tool/assets/images/youtube.png"/></a>
  </div>
</div>
      </main>

    </div>
  </body>

  

  <script defer src="/what-if-tool/assets/js/material.min.js"></script>
  <script defer src="/what-if-tool/assets/js/material-components-web.min.js"></script>
</html>
